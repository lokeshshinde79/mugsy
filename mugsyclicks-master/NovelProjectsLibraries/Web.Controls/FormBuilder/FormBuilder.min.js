$(function(){a();f();y();if(c.val()!="00000000-0000-0000-0000-000000000000"&&c.val()!=""){g()}var e,w,h,z,b,p,m,v,r,q,k,c,x,u,d;function a(){e=$(".QID");w=$(".QLabel");h=$(".QType input");z=$(".QValues");b=$(".QRequired input");p=$(".QValidationType");m=$(".QRows");v=$(".QMaxLength");r=$(".QWidth");q=$(".QRepeatDirection input");k=$(".QRepeatColumns");c=$(".FormID");x=$(".FormName");u=$(".FormSendEmail");d=$(".FormEmail")}$(".AddQuestion").click(function(){if(h.filter(":checked").val()=="Check Box List"||h.filter(":checked").val()=="Check Box"){b.filter(":first").attr("checked",true)}$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/SaveQuestion",data:o(),dataType:"json",contentType:"application/json; charset=utf-8",success:function(B){var A=B.d;if(A==undefined||A==null){A=B}A=A.parseJSON();c.val(A.FormID);$("#EditQuestionsList").html("");t(A);$(".ConfigTabs").tabs("select",1);l();j()},error:function(B,A){alert("fail: "+A+"\n "+B.responseText)}})});$(".CancelQuestion").click(function(){j()});function t(A){for(var B=0;B<A.Questions.length;B++){$("#EditQuestionsList").append("<a id='"+A.Questions[B].ID+"' href='javascript:void(0);' class='Delete' alt='Delete' title='Delete'></a>");$("#EditQuestionsList").append("<a id='"+A.Questions[B].ID+"' href='javascript:void(0);' class='MoveDown' alt='Move Down' title='Move Down'></a>");$("#EditQuestionsList").append("<a id='"+A.Questions[B].ID+"' href='javascript:void(0);' class='MoveUp' alt='Move Up' title='Move Up'></a>");$("#EditQuestionsList").append("<a id='"+A.Questions[B].ID+"' href='javascript:void(0);' class='LoadQuestion Edit' title='Edit Question'></a>");$("#EditQuestionsList").append(A.Questions[B].Label);$("#EditQuestionsList").append("<br/><br/>")}}function l(){$(".LoadQuestion").click(function(){var A=$(this).attr("id");$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/LoadQuestion",data:"{ 'ID':'"+A+"'}",dataType:"json",contentType:"application/json; charset=utf-8",success:function(C){var B=C.d;if(B==undefined||B==null){B=C}B=B.parseJSON();$("#AddForm strong").text("Edit Question:");w.val(B.Label);e.val(B.ID);h.filter("[value='"+B.Type+"']").attr("checked",true);z.val(B.Values.replace(/\|/g,"\n"));b.filter("[value='"+B.Required+"']").attr("checked",true);p.val(B.ValidationType);m.val(B.Rows);v.val(B.MaxLength);r.val(B.Width);q.filter("[value='"+B.RepeatDirection+"']").attr("checked",true);k.val(B.RepeatColumns);y();$(".ConfigTabs").tabs("select",0)},error:function(C,B){alert("fail: "+B+"\n "+C.responseText)}})});$(".MoveUp").click(function(){var A=$(this).attr("id");s(A,"MoveUp")});$(".MoveDown").click(function(){var A=$(this).attr("id");s(A,"MoveDown")});$(".Delete").click(function(){var A=confirm("Are you sure you want to delete this question?");if(A){var B=$(this).attr("id");s(B,"Delete")}})}function s(B,A){$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/SwapQuestions",data:"{ 'ID':'"+B+"','MoveCommand':'"+A+"'}",dataType:"json",contentType:"application/json; charset=utf-8",success:function(D){var C=D.d;if(C==undefined||C==null){C=D}C=C.parseJSON();$("#EditQuestionsList").html("");t(C);l();j()},error:function(D,C){alert("fail: "+C+"\n "+D.responseText)}})}function g(){$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/LoadForm",data:"{ 'FormID':'"+c.val()+"'}",dataType:"json",contentType:"application/json; charset=utf-8",success:function(B){var A=B.d;if(A==undefined||A==null){A=B}A=A.parseJSON();x.val(A.FormName);u.attr("checked",A.FormSendEmail);d.val(A.FormEmail);y();$("#EditQuestionsList").html("");t(A);l();j()},error:function(B,A){alert("fail: "+A+"\n "+B.responseText)}})}$(".SaveForm").click(function(){$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/SaveForm",data:n($(this).attr("title")=="Save Form",$(this).attr("title")=="Save For Later"),dataType:"json",contentType:"application/json; charset=utf-8",success:function(A){i();j()},error:function(B,A){alert("fail: "+A+"\n "+B.responseText)}})});$(".ClearForm").click(function(){var A=confirm("Are you sure you want to delete this form?");if(A){$.ajax({type:"POST",url:"NovelProjects.Web.FormBuilder.FormBuilderService.asmx/ClearForm",data:"{'ID':'"+c.val()+"'}",dataType:"json",contentType:"application/json; charset=utf-8",success:function(B){i();j()},error:function(C,B){alert("fail: "+B+"\n "+C.responseText)}})}});function o(){var A="{ Ques: {";A+=' ID:"'+e.val()+'",';A+=' FormID:"'+c.val()+'",';A+=' Label:"'+w.val()+'",';A+=' Type:"'+h.filter(":checked").val()+'",';A+=' Values:"'+z.val().replace(/\n/g,"|")+'",';A+=' Required:"'+b.filter(":checked").val()+'",';A+=' ValidationType:"'+p.val()+'",';A+=' Rows:"'+m.val()+'",';A+=' MaxLength:"'+v.val()+'",';A+=' Width:"'+r.val()+'",';A+=' RepeatDirection:"'+q.filter(":checked").val()+'",';A+=' RepeatColumns:"'+k.val()+'"';A+="} }";return A}function n(C,B){var A="{ Form: {";A+=' ID:"'+c.val()+'",';A+=' Name:"'+x.val()+'",';A+=' SendEmail:"'+u.attr("checked")+'",';A+=' Email:"'+d.val()+'",';A+=' Visible:"'+C+'",';A+=' Saved:"'+B+'"';A+="} }";return A}function j(){e.val("00000000-0000-0000-0000-000000000000");w.val("");h.filter(":first").attr("checked",true);z.val("");b.filter(":first").attr("checked",true);$("#QValidationType").attr("selectedIndex","0");m.val("1");v.val("100");r.val("140");q.filter(":first").attr("checked",true);k.val("1");$("#AddForm strong").text("Add a New Question:");y()}function i(){$("#EditQuestionsList").html("");c.val("00000000-0000-0000-0000-000000000000");x.val("New Form");u.attr("checked",false);d.val("")}function f(){$(".ConfigTabs").tabs().tabs("select",2);$(h).click(function(){y()});$(b).click(function(){y()});$(u).click(function(){y()})}function y(){$(".QText").hide();$(".QRadio").hide();$(".QValuesRow").hide();$(".QRequiredType").hide();$(".QRequiredRow").show();var A=h.filter(":checked").val();var B=b.filter(":checked").val();if(A=="Text Field"){$(".QText").show();if(B=="True"){$(".QRequiredType").show()}}if(A=="Check Box List"||A=="Radio Button List"){$(".QRadio").show()}if(A=="Check Box List"||A=="Check Box"){$(".QRequiredRow").hide()}if(A=="Radio Button List"||A=="Check Box List"||A=="List Box"||A=="Drop Down List"){$(".QValuesRow").show()}if($(".FormSendEmail input:checked").val()!=null){$(".FormSendEmailRow").show()}else{$(".FormSendEmailRow").hide()}}});String.parseJSON=(function(s){var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};s.parseJSON=function(filter){try{if(/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(this)){var j=eval("("+this+")");if(typeof filter==="function"){function walk(k,v){if(v&&typeof v==="object"){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i])}}}return filter(k,v)}j=walk("",j)}return j}}catch(e){}throw new SyntaxError("Trouble loading data please contact support@novelprojects.com")}})(String.prototype);function SyntaxError(a){alert(a)};