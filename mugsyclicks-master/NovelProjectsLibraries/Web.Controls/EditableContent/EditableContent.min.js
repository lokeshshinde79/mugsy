function EnableApprove(){$(".ApproveEditableContent").removeAttr("disabled")}function FCKeditor_OnComplete(a){a.Events.AttachEvent("OnSelectionChange",EnableApprove)}$(function(){BindFunctions()});function BindFunctions(){var c,b;$("div.EditableTooltip:not(.tooltip)").tooltip({track:true,delay:0,showURL:false,showBody:" - "});$("div.EditableTooltip").unbind("dblclick").dblclick(function(){var d=$(this);$(".DisableSaveEditableContent").hide();$(".SaveEditableContent").show();if($("#Popup_"+d.attr("id")).length>1){$("#Popup_"+d.attr("id")+":first").remove()}d.find("div.EditableContent:first").find(".npTabs").tabs();$("#Popup_"+d.attr("id")).npModal({width:"780px",height:"545px",sender:"#SiteManagerPopup",toggleHide:true,overlayClass:".EditContentOverlay"});c=d.find("span.ContentID:first").text();b=$("span.Editor_"+c).text()});$("div.EditableTooltip").unbind("hover").hover(function(){$(this).removeClass("EditBoxOff").addClass("EditBoxOn")},function(){$(this).removeClass("EditBoxOn").addClass("EditBoxOff")});$("input.SaveEditableContent").unbind("click").click(function(){var e=$(this);var d=e.closest(".npTabs").find(".VersionId").html();e.hide();$(".DisableSaveEditableContent").show();$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/SaveApprove",data:"{ ID:'"+d+"', ContentID:'"+c+"', Content:'"+a()+"', Approve:'"+e.nextAll(".ApproveEditableContent:first").find("input").is(":checked")+"', IsNew:'"+e.nextAll(".SaveNewContent:first").find("input").is(":checked")+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(g){var f=(g.d==undefined||g.d==null)?g:g.d;if(f!="Success"){alert(f)}location.href=location.href},error:function(g,f){alert("Error saving content")}});return false});$("a.btnCreateNewVersion").die("click").live("click",function(){var d=$(this);$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/CreateNew",data:"{ ContentID:'"+c+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(k){var g=(k.d==undefined||k.d==null)?k:k.d;var j=(g);var f=/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/;var e;if(f.test(j)){d.closest(".npTabs").find(".VersionId").html(j);d.closest(".npTabs").find(".modifyapprove").hide();var h=FCKeditorAPI.GetInstance(d.closest(".HistoryPages").attr("editorid"));h.SetHTML("");d.closest(".npTabs").tabs("select",0);var i=new Date();d.replaceWith(i.getMonth()+"/"+i.getDay()+"/"+i.getFullYear()+" "+i.toLocaleTimeString())}else{alert(g)}},error:function(f,e){alert("Error creating new version")}});return false});$("input.CancelEditableContent").unbind("click").click(function(){if($("#SiteManagerPopup").size()==1){$(this).closest("div.EditableContent").npModalDestroy({destroyOverlay:false})}else{location.href=location.href}return false});$("input.btnApproveContent").unbind("click").click(function(){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/Approve",data:"{ ID:'"+$(this).attr("id")+"', NewSave:'false', Content:'', ContentID:'"+c+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(e){var d=(e.d==undefined||e.d==null)?e:e.d;if(d!="Success"){alert(d)}location.href=location.href},error:function(e,d){alert("Error approving content")}})});$("input.btnPublishContent").unbind("click").click(function(){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/Publish",data:"{ ID:'"+$(this).attr("id")+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(e){var d=(e.d==undefined||e.d==null)?e:e.d;if(d!="Success"){alert(d)}location.href=location.href},error:function(e,d){alert("Error publishing content")}})});$("input.EditableName").unbind("blur").blur(function(){var d=$(this);$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/SaveName",data:"{ ID:'"+d.attr("id")+"', Name:'"+d.val()+"' }",success:function(f){var e=(f.d==undefined||f.d==null)?f:f.d;if(e!="Success"){alert(e)}},error:function(f,e){alert("Error saving version name")}})});$("img.btnEditContent").unbind("click").click(function(){var d=$(this);$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/LoadContent",data:"{ ID:'"+d.attr("id")+"' }",success:function(g){var e=(g.d==undefined||g.d==null)?g:g.d;d.closest(".npTabs").find(".VersionId").html(d.attr("id"));d.closest(".npTabs").find(".modifyapprove").hide();var f=FCKeditorAPI.GetInstance(d.closest(".HistoryPages").attr("editorid"));f.SetHTML(e);d.closest(".npTabs").tabs("select",0)},error:function(f,e){alert("Error editing content")}})});$("img.btnCopyContent").unbind("click").click(function(){var d=$(this);$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/CopyContent",data:"{ ID:'"+d.attr("id")+"', ContentID:'"+c+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(i){var g=(i.d==undefined||i.d==null)?i:i.d;var h=(g);var f=/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/;var e;if(f.test(h)){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/LoadContent",data:"{ ID:'"+h+"' }",success:function(l){var j=(l.d==undefined||l.d==null)?l:l.d;d.closest(".npTabs").find(".VersionId").html(h);d.closest(".npTabs").find(".modifyapprove").hide();var k=FCKeditorAPI.GetInstance(d.closest(".HistoryPages").attr("editorid"));k.SetHTML(j);d.closest(".npTabs").tabs("select",0)},error:function(k,j){alert("Error loading new copy")}})}else{alert(g)}},error:function(f,e){alert("Error copying version")}});return false});$("img.btnDeleteContent").unbind("click").click(function(){var e=$(this);var d=confirm("Are you sure you want to delete this revision? This action is irreversible.");if(d){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"NovelProjects.Web.EditableContent.EditableContentService.asmx/Delete",data:"{ ID:'"+e.attr("id")+"', PageUrl:'"+$("#SiteManagerPopup .NodeUrl").val()+"' }",success:function(h){var f=(h.d==undefined||h.d==null)?h:h.d;if(f!="Success"){alert(f)}else{var g="";if(e.closest("tr").hasClass("alt")){g="alt"}e.closest("tr").replaceWith('<tr class="'+g+'"><td><a href="javascript:void(0);" class="btnCreateNewVersion">Create New</a></td><td/><td/><td/><td/><td/><td/><td/></tr>')}},error:function(g,f){alert("Error deleting content")}})}});function a(){return escape(FCKeditorAPI.GetInstance(b).GetHTML()).replace(/\+/g,"%2B")}};