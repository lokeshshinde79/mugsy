(function(g) { var a = g.browser.msie; var f = (g.browser.msie && parseInt(g.browser.version.substr(0, 1)) < 7); var l, j, d; g.fn.npModal = function(p) { var c = { containerTarget: "#modalTarget", targetClass: "div.npContent", overlayClass: ".npOverlay", closeClass: "div.npClose", dragClass: "div.npTitle", enableOverlayClose: false, enableEscape: true, title: false, enableDrag: false, isModal: true, animate: false, ajax: false, toTop: false, destroyOverlay: true, toggleHide: true, sender: null, overlay: 50, autoPosition: true, width: "620px", height: "auto", closeCallback: null }; d = g.extend(c, p); var n = new Object(); return this.each(function() { n.containerTarget = g(this); d.containerTarget = (n.containerTarget.attr("id") != null ? "#" + n.containerTarget.attr("id") : c.containerTarget); n.targetClass = g(d.targetClass); n.overlayClass = g(d.overlayClass); n.closeClass = n.containerTarget.find(d.closeClass); n.dragClass = n.containerTarget.find(d.dragClass); if (d.sender != null) { n.sender = g(d.sender) } m(n) }) }; g.fn.npModalDestroy = function(c) { if (d == undefined) { d = new Object() } if (c != undefined || c != null) { d.destroyOverlay = (c.destroyOverlay != null) ? c.destroyOverlay : true; d.animate = (c.animate != null) ? c.animate : false } else { d.destroyOverlay = true; d.animate = false } d.containerTarget = this; b() }; function m(p) { j = ""; l = ""; l = p.containerTarget; var A = 3000; var r = g("<div></div>").css({ height: "100%", width: "100%", position: "fixed", left: 0, top: 0, "z-index": A - 1, opacity: d.overlay / 100 }); if (p.overlayClass.length == 0) { r.addClass(d.overlayClass.substring(1, d.overlayClass.length)).appendTo("body"); p.overlayClass = g(d.overlayClass) } if (f) { g("html,body").css({ height: "100%", width: "100%", "z-index": A - 1 }); r = r.css({ position: "absolute" }); var E = parseInt(l.css("padding-top").replace("px", ""), 10); var B = parseInt(l.css("padding-bottom").replace("px", ""), 10); var u = parseInt(l.css("padding-left").replace("px", ""), 10); var n = parseInt(l.css("padding-right").replace("px", ""), 10); var x = g("<iframe></iframe>").css({ opacity: 0, width: v + u + n + "px", height: c + E + B + "px", left: 0, top: 0, "z-index": "-1", position: "absolute" }); l.prepend(x) } if (d.autoPosition) { l.css({ width: d.width, height: d.height, "z-index": A }).appendTo("form"); var v = parseInt(l.width(), 10); var c = parseInt(l.height(), 10); var z = 0; var y = h(); var D = e(); if (d.toTop) { z = "15%" } else { z = (D == 0) ? ((y - c) / 2) : (((y - c) / 2) + D) } l.css("top", z); var q = 0; var C = k(); q = ((C - v) / 2); l.css("left", q); if (d.animate && !a) { l.fadeIn() } else { l.show() } } if (d.isModal) { p.overlayClass.css("display", "block") } else { p.overlayClass.css("display", "none") } if (d.enableDrag) { try { l.draggable({ handle: d.dragClass }); p.dragClass.css({ cursor: "move" }) } catch (t) { } } if (d.title != false) { p.dragClass.find("h1").text(d.title) } if (d.ajax != false) { g.ajax({ type: "GET", url: d.ajax, success: function(o, s) { p.targetClass.html(o); c = parseInt(l.height(), 10); if (!d.toTop) { z = (D == 0) ? ((y - c) / 2) : (((y - c) / 2) + D); if (z < 0) { z = 0 } l.css("top", z) } if (d.animate && !a) { l.slideDown() } else { l.show() } }, error: function(o, w, s) { alert("Error Loading '" + d.ajax + "'") } }) } else { if (d.animate && !a) { l.fadeIn() } else { l.show() } } if (d.sender != null) { j = p.sender; if (d.toggleHide) { j.hide() } } else { j = l } p.closeClass.attr("cid", d.containerTarget).attr("d", d.destroyOverlay).attr("a", d.animate).click(b); if (d.enableEscape) { g(document).keydown(i) } if (d.isModal && d.enableOverlayClose) { p.overlayClass.click(function() { b() }) } } function b(r) { var p = g(this); var n = d.containerTarget; var t = d.destroyOverlay; var c = d.animate; if (p != null) { n = (p.attr("cid") != null) ? g(p.attr("cid")) : g(n); t = ((p.attr("d") != null) && (p.attr("d") == "false")) ? false : d.destroyOverlay; c = ((p.attr("a") != null) && (p.attr("a") == "false")) ? false : d.animate } var s = d; var q = (s.closeCallback != null) ? true : false; if (s.isModal && t) { g(s.overlayClass).css("display", "none") } if (c && !a) { if (q) { n.fadeOut("normal", s.closeCallback) } else { n.fadeOut() } } else { if (q) { n.hide(1, s.closeCallback) } else { n.hide() } } if (j != l && s.toggleHide) { l = n = j; t = true; s.sender = null; d.destroyOverlay = t; if (s.animate && !a) { j.fadeIn() } else { j.show() } } } function i(c) { if (c.keyCode == 27) { b() } } function h() { var c = 0; if (typeof (window.innerHeight) == "number") { c = window.innerHeight } else { if (document.documentElement && document.documentElement.clientHeight) { c = document.documentElement.clientHeight } else { if (document.body && document.body.clientHeight) { c = document.body.clientHeight } } } return c } function k() { var c = 0; if (typeof (window.innerWidth) == "number") { c = window.innerWidth } else { if (document.documentElement && document.documentElement.clientWidth) { c = document.documentElement.clientWidth } else { if (document.body && document.body.clientWidth) { c = document.body.clientWidth } } } return c } function e() { var c = 0; if (typeof (window.pageYOffset) == "number") { c = window.pageYOffset } else { if (document.body && (document.body.scrollLeft || document.body.scrollTop)) { c = document.body.scrollTop } else { if (document.documentElement && (document.documentElement.scrollLeft || document.documentElement.scrollTop)) { c = document.documentElement.scrollTop } } } return c } })(jQuery);